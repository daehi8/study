## 21. 인터페이스는 구현하는 쪽을 생각해 설계하라

### 자바 8 이전

- 기존 구현체를 깨뜨리지 않고 인터페이스에 메서드 추가 불가능
- 인터페이스에 메서드를 추가하면 컴파일 오류



### 디폴트 메서드

- 선언하면 그 인터페이스를 구현한 후 디폴트 메서드를 재정의 하지 않은 모든 클래스에서 디폴트 구현이 쓰이게 된다.
- 모든 구현체들과 매끄럽게 연동된다는 보장은 없다.
- 람다를 활용하기 위해 핵심 컬렉션 인터페이스들에 다수의 디폴트 메서드가 추가되었지만 모든 상황에서 불변식을 해치지지 않는 디폴트 메서드를 작성하기는 어려운 법이다.
- 자바 플랫폼 라이브러리에서는 이런 문제를 해결하기 위해 일련의 조치를 취했지만 제3의 기존 컬렉션 구현체들은 수정되지 않은 것들이 많다.
- 컴파일에 성공하더라도 기존 구현체에 런타임 오류를 일으킬 수 있다.
- 기존 인터페이스에 디폴트 메서드로 새 메서드를 추가하려는 일은 꼭 필요한 경우가 아니면 피해야 한다.
- 새로운 인터페이스를 만드는 경우라면 표준적인 메서드 구현을 제공하는 데 아주 유용한 수단이 된다.
- 인터페이스로부터 메서드를 제거하거나 기존 메서드의 시그니처를 수정하는 용도가 아니다.



### 핵심

- 디폴트 메서드라는 도구가 생겼어도 인터페이스를 설계할 때는 여전히 세심한 주의를 기울여야 한다.
- 새로운 인터페이스라면 릴리스 전에 반드시 테스트를 거쳐야 한다.
- 서로 다른 방식으로 최소한 세 가지는 구현해봐야 하며 각 인터페이스의 인스턴스를 다양한 작업에 활용하는 클라이언트도 여러 개 만들어 봐야 한다.
- 인터페이스를 릴리스한. 후라도 결함을 수정하는 게 가능한 경우도 있겠지만 절대 그 가능성에 기대서는 안 된다.





